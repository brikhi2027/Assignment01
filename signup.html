<!--
=================================================================
Name: signup.html
Assignment: 2
Authors: Bhavna Rikhi (UCID: 30171786) & Anastasia Zaharia (UCID: 30184046)
Submission: February 23, 2024
Description: Signup page of e-commerce website 
=================================================================
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- meta tags, title, and links to styles.css placed here-->
    <title>ShoeZ & Co</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The signup page of an e-commerce website for shoes.">
    <meta name="keywords" content="shoes, footwear, e-commerce ">
    <meta name="author" content="Bhavna Rikhi, Anastasia Zaharia">
    <link rel="stylesheet" href="styles.css">
    <link rel="shortcut icon" href ="ecomerce_favicon.ico" type="image/x-icon">
</head>
<body>
    <header>
        <!-- logo and website name go here-->
        <div class="companylogo">
            <img src="images/colorful_logo.jpg" alt="Shoe Company Logo"/>
        </div>

        <div class="companyname">
            <h1>ShoeZ & Co</h1>
        </div>
    </header>

    <div>
        <!-- navigation links go here-->
        <nav>
            <a href="index.html">Back to Home</a>
            <br>
            <a href="products.html">Products</a>
            <br>
            <a href="contact.html">Contact</a>
            <br>
            <a href="login.html">Login</a>
            <br>
        </nav>
    </div>

    <main>
        <section class = "signupForm">
            <h2>Sign-Up</h2>
            <form action = "#" method = "post">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required placeholder="Create your username">
                <br>
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required placeholder="Create your password">
                <br>
                <label for="password">Confirm Password:</label>
                <input type="password" id="confirmPassword" name="password" required placeholder="Re-enter your password">
                <br>
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required placeholder="Enter your email">
                <br>
                <button type="submit" onclick="validateData(event)">Sign Up</button>
                <script>
                    function validateData(event){
                        event.preventDefault();
                        const usernameInput = document.getElementById('username').value;
                        const passwordInput = document.getElementById('password').value;
                        const confirmPasswordInput = document.getElementById('confirmPassword').value;
                        const emailInput = document.getElementById('email').value;

                        //error messages
                        let usernameError = "";
                        let passwordError = "";
                        let confirmPasswordError = "";
                        let emailError = "";
                        let errors = "";

                        //validate Username
                        let allowedCharacters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_';
                        let letters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

                        let allowedChars = true;
                        let letter = false;
                        let valid_len = false;
                        let valid_username = false;

                        if (usernameInput.length >= 3 && usernameInput.length <= 20){
                            valid_len = true;
                        }
                        if (letters.includes(usernameInput[0])){
                            letter = true;
                        }
                        for (let i = 0; i < usernameInput.length; i++){
                            if (!allowedCharacters.includes(usernameInput[i])){
                                allowedChars = false;
                                break;
                            }
                        }
                        if (!(allowedChars && letter && valid_len)){
                            valid_username = false;
                        }
                        else{
                            valid_username = true;
                        }
                        if (!valid_username){
                            usernameError = "Error in username.";
                            errors += usernameError + " ";
        
                        }
                        
                        //validate password
                        let specialCharacters = '!@#$%^&*()-_=+[]{}|;:\'",.<>?/`~';
                        let uppercaseLetters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                        let lowercaseLetters = 'abcdefghijklmnopqrstuvwxyz';
                        let numbers = '0123456789';
                        let allowed = '!@#$%^&*()-_=+[]{}|;:\'",.<>?/`~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'

                        let len = false;
                        let special = false;
                        let upper = false;
                        let lower = false;
                        let num = false;
                        let chars = true;
                        let valid_password = false;
                        let confirm_password = false;
                        
                        if (passwordInput.length >= 8){
                            len = true;
                        }
                        for (let i = 0; i < passwordInput.length; i++){
                            if (specialCharacters.includes(passwordInput[i])){
                                special = true;
                            }
                            if (uppercaseLetters.includes(passwordInput[i])){
                                upper = true;
                            }
                            if (lowercaseLetters.includes(passwordInput[i])){
                                lower = true;
                            }
                            if (numbers.includes(passwordInput[i])){
                                num = true;
                            }
                            if (!allowed.includes(passwordInput[i])){
                                chars = false;
                                break;
                            }
                        }

                        if (!(len && special && upper && lower && num && chars)){
                            valid_password = false;
                        }
                        else{
                            valid_password = true;
                        }
                        
                        if (!valid_password){
                            passwordError = "Error in password.";
                            errors += passwordError + " ";
                            
                        }
                        else{ //confirm password
                            if (passwordInput != confirmPasswordInput){
                                confirm_password = false;
                            }
                            else{
                                confirm_password = true;
                            }
                        }
                        if (!confirm_password){
                            confirmPasswordError = "Password does not match.";
                            errors += confirmPasswordError + " ";
                        }

                        //validate email
                        let atSign = false;
                        let oneAtSign = false;
                        let info_part = false;
                        let domain_period = false;
                        let domain_part = false;
                        let valid_email = false;

                        let allowedDomains = ['com', 'ca', 'org', 'biz', 'tv', 'net', 'info', 'io', 'me'];
                        if (emailInput.indexOf("@") !== -1){
                            atSign = true;
                            var email_parts = emailInput.split("@");
                            var personal_info = email_parts[0];
                            var domain_info = email_parts[1];
                            if (email_parts.length === 2){
                                oneAtSign = true;
                            }
                            if (personal_info.length !== 0 && personal_info.indexOf(" ") === -1){
                                info_part = true;
                            }
                            if (domain_info.length !== 0 && domain_info.indexOf(" ") === -1){
                                if (domain_info.indexOf(".") !== -1){
                                    domain_period = true;
                                }
                                if (domain_period){
                                    var domainSplit = domain_info.split(".");
                                    var domainName = domainSplit[1];
                                    if (allowedDomains.includes(domainName)){
                                        domain_part = true;
                                    }
                                }
                            }
                        }
                        
                        if (!(atSign && oneAtSign && info_part && domain_part)){
                            valid_email = false;
                        }
                        else{
                            valid_email = true;
                        }

                        if (!valid_email){
                            emailError = "Invalid email.";
                            errors += emailError + " ";
                        }

                        if (errors){
                            if (document.querySelector('#message-box') == null){
                                signupMessage();
                            }
                            let messageContent = document.getElementById('signUpMessage');
                            messageContent.textContent = errors;
                            
                        }
                        else{
                            if (document.querySelector('#message-box') == null){
                                signupMessage();
                            }
                            let successMessage = document.getElementById('signUpMessage');
                            successMessage.textContent = "Successful sign-up!";
                        }
                        
                    }

                    function signupMessage(){
                        var message_container = document.createElement('div');
                        message_container.id = 'message-box';
                        message_container.style.backgroundColor = "#f9f9f9";
                        message_container.style.border = "2px solid black";
                        message_container.style.padding = "10px";
                        message_container.style.margin = "20px";

                        var message = document.createElement('p');
                        message.id = 'signUpMessage';

                        message_container.appendChild(message);
                        document.querySelector('main').appendChild(message_container);
                    }
                </script>
        </section>
    </main>

    <footer>
        <!--copyright notice goes here-->
        <p>&copy;2024 ShoeZ & Co. All rights reserved.</p>
    </footer>

</body>
</html>